# 📊 Naver Works 경비 CSV 업로더

Naver Works 법인카드 지출결의 양식에 CSV 파일을 자동으로 입력해주는 Chrome Extension입니다.

## ✨ 주요 기능

- **📁 CSV 파일 업로드**: 드래그 & 드롭 또는 파일 선택으로 간편하게 업로드
- **🔍 데이터 미리보기**: 입력 전 데이터를 확인하고 검증
- **✅ 자동 검증**: 날짜, 금액 형식 등을 자동으로 체크
- **📊 진행 상황 표시**: 실시간으로 입력 진행률 확인
- **⚠️ 에러 리포트**: 문제가 있는 행을 자세히 알려줌
- **🎯 헤더 자동 인식**: CSV에 헤더가 없어도 자동으로 처리

## 📋 CSV 형식

다음 컬럼이 포함되어야 합니다 (순서대로):

1. **사용 일자** - 날짜 형식 (예: 2025.09.15, 20250915, 2025-09-15)
2. **사용 항목** - 항목명 또는 번호 (예: 식대, 1)
3. **사용 내역(+목적)** - 사용 내역
4. **사용처** - 사용한 장소/업체
5. **사용금액** - 금액 (예: 50000, 50,000, 50,000원)
6. **비고(참석자 등 필요 기재사항)** 또는 **비고(참석자 등)** - 비고 사항

### CSV 예시

```csv
사용 일자,사용 항목,사용 내역(+목적),사용처,사용금액,비고(참석자 등 필요 기재사항)
2025.09.01,식대,점심식사,스타벅스,15000,김철수
2025.09.02,교통비,출장,KTX,50000,
2025.09.03,1,저녁회식,한식당,80000,김철수 외 3명
```

**참고**: 
- 비고 컬럼은 "비고(참석자 등 필요 기재사항)" 또는 "비고(참석자 등)" 또는 "비고" 모두 인식됩니다
- 첫 행에 헤더가 없어도 자동으로 인식됩니다
- 탭(TSV) 또는 쉼표(CSV) 구분 모두 지원
- 엑셀에서 "다른 이름으로 저장" → CSV로 저장하면 됩니다

## 🚀 설치 방법

### 1. 파일 다운로드

이 폴더의 모든 파일을 다운로드하세요:
- `manifest.json`
- `content.js`
- `parser.js`
- `styles.css`
- `popup.html`
- `popup.js`
- `icon16.png`
- `icon48.png`
- `icon128.png`

### 2. Chrome에 Extension 설치

1. Chrome 브라우저를 열고 주소창에 `chrome://extensions/` 입력
2. 우측 상단의 **개발자 모드** 토글을 활성화
3. **압축해제된 확장 프로그램을 로드합니다** 클릭
4. 다운로드한 폴더를 선택
5. 설치 완료! 🎉

## 📖 사용 방법

### 단계별 가이드

1. **Naver Works 경비 페이지 접속**
   - Naver Works에 로그인
   - 법인카드 지출결의 작성 페이지로 이동
   - URL 예시: `https://ajd.ncpworkplace.com/user/write/fg-dfm/...`

2. **CSV 업로드 버튼 클릭**
   - 페이지 상단에 자동으로 생성된 "📊 CSV 업로드" 버튼 클릭

3. **CSV 파일 선택**
   - 드래그 & 드롭 또는 클릭하여 파일 선택
   - 파일이 자동으로 파싱됩니다

4. **미리보기 확인**
   - 데이터가 올바른지 확인
   - 검증 결과 확인 (오류/경고)

5. **입력 시작**
   - "입력 시작" 버튼 클릭
   - 진행 상황을 실시간으로 확인

6. **완료!**
   - 입력이 완료되면 결과 확인
   - 실패한 행이 있다면 상세 내용 표시

## 🔧 고급 설정

### 사용 항목 매칭

CSV의 "사용 항목" 컬럼은 다음과 같이 입력할 수 있습니다:

- **항목명 직접 입력**: "식대", "교통비" 등
- **번호로 입력**: 1, 2, 3 등 (드롭다운 순서)

Extension이 자동으로 매칭하며, 매칭되지 않는 항목은 콘솔에 경고가 표시됩니다.

### 날짜 형식

다음 형식을 모두 지원합니다:
- `2025.09.15` (점 구분)
- `2025-09-15` (하이픈 구분)
- `2025/09/15` (슬래시 구분)
- `20250915` (숫자만)
- `2025.10.01` (10월, 11월, 12월도 지원)
- `2025-11-23` (모든 월 지원)

### 금액 형식

다음 형식을 모두 지원합니다:
- `50000`
- `50,000`
- `50,000원`
- `₩50,000`

## ⚠️ 문제 해결

### "폼을 찾을 수 없습니다" 오류

- 올바른 경비 페이지에 있는지 확인
- 페이지를 새로고침
- Extension을 비활성화 후 다시 활성화

### CSV 파싱 오류

- CSV 파일 형식 확인 (UTF-8 인코딩 권장)
- 엑셀에서 저장 시 "CSV UTF-8" 형식으로 저장
- 특수문자가 포함된 경우 큰따옴표로 감싸기

### 데이터가 입력되지 않음

- 브라우저 콘솔(F12) 확인
- 항목명이 정확한지 확인
- UID 값이 변경되지 않았는지 확인 (content.js 첫 부분)

### Extension이 작동하지 않음

- `chrome://extensions/`에서 Extension 활성화 확인
- "오류" 버튼이 있다면 클릭하여 상세 내용 확인
- 페이지 새로고침 시도

## 🛠️ 개발자 정보

### 파일 구조

```
naver-works-expense-uploader/
├── manifest.json          # Extension 설정 파일
├── content.js            # 메인 로직 및 UI
├── parser.js             # CSV 파싱 및 검증
├── styles.css            # UI 스타일
├── popup.html            # Extension 팝업 UI
├── popup.js              # 팝업 로직
├── icon16.png            # 아이콘 (16x16)
├── icon48.png            # 아이콘 (48x48)
├── icon128.png           # 아이콘 (128x128)
└── README.md             # 이 파일
```

### 커스터마이징

#### UID 변경
Naver Works의 양식 ID가 변경된 경우 `content.js`의 `UID` 값을 수정:

```javascript
const UID = 'your-new-uid-here';
```

#### 컬럼 ID 변경
컬럼 ID가 변경된 경우 `content.js`의 `COLS` 객체를 수정:

```javascript
const COLS = {
  date: 'new-date-column-id',
  item: 'new-item-column-id',
  // ...
};
```

#### 스타일 변경
`styles.css` 파일을 수정하여 UI 색상이나 레이아웃을 변경할 수 있습니다.

## 📝 버전 히스토리

### v1.0.0 (2025-10-26)
- 🎉 초기 릴리즈
- CSV 파일 업로드 기능
- 데이터 미리보기 및 검증
- 진행 상황 표시
- 에러 리포트
- 헤더 자동 인식

## 🤝 기여

버그 리포트나 기능 제안은 언제나 환영합니다!

## 📄 라이선스

개인 및 회사 내부 사용 목적으로 자유롭게 사용 가능합니다.

## 💡 팁

- **대량 데이터**: 한 번에 너무 많은 데이터를 입력하면 브라우저가 느려질 수 있습니다. 50행 이하를 권장합니다.
- **엑셀 팁**: 엑셀에서 "다른 이름으로 저장" → "CSV UTF-8" 형식으로 저장하세요.
- **백업**: 중요한 데이터는 입력 전에 백업해두세요.
- **테스트**: 처음 사용할 때는 몇 개의 행으로 먼저 테스트해보세요.

---

Made with ❤️ for productivity
